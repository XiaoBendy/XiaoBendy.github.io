<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Java对象创建过程详解 | XiaoBendy</title>

  
  <meta name="author" content="XiaoBendy">
  

  
  <meta name="description" content="概述Java对象创建分为两个过程：声明对象和创建对象实体。类信息，对象引用，对象实体均在内存的不同区域。   
内存结构每一个Java引用程序均会唯一的对应一个JVM实例，而这个JVM实例将会完成对象内存分配，程序运行，垃圾回收等工作。JVM将其内存大致分类三个区域：方法区，栈区，堆区。

方法区：是JVM在装载类文件时，用于存储类的所有描述信息的，这些信息主要包括，类的基本信息（访问修饰符，类名），字段信息（修饰符，类型，字段名），方法信息（修饰符，返回值类型，方法名，参数列表类型，异常，方法体字节码等等），常量池，静态区，classloader以及class引用。
栈区：存放局部变量，基本数据类型和对象引用类型
堆区：用于存放new产生对象的实体，每一个对象实体均会有自己的内存地址，一旦这个内存地址不被任何栈区对象引用，就会成为垃圾，随时会被GC回收。">
  

  
  
  <meta name="keywords" content="Java">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="Java对象创建过程详解"/>

  <meta property="og:site_name" content="XiaoBendy"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="XiaoBendy" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">XiaoBendy</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/categories">Categories</a></li>
      
        <li><a href="/tag">Tags</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>Java对象创建过程详解</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/02/22/Java对象创建过程详解/" rel="bookmark">
        <time class="entry-date published" datetime="2021-02-22T06:59:21.000Z">
          2021-02-22
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>Java对象创建分为两个过程：声明对象和创建对象实体。类信息，对象引用，对象实体均在内存的不同区域。   </p>
<h2 id="内存结构"><a href="#内存结构" class="headerlink" title="内存结构"></a>内存结构</h2><p>每一个Java引用程序均会唯一的对应一个JVM实例，而这个JVM实例将会完成对象内存分配，程序运行，垃圾回收等工作。JVM将其内存大致分类三个区域：方法区，栈区，堆区。</p>
<ul>
<li>方法区：是JVM在装载类文件时，用于存储类的所有描述信息的，这些信息主要包括，类的基本信息（访问修饰符，类名），字段信息（修饰符，类型，字段名），方法信息（修饰符，返回值类型，方法名，参数列表类型，异常，方法体字节码等等），常量池，静态区，classloader以及class引用。</li>
<li>栈区：存放局部变量，基本数据类型和对象引用类型</li>
<li>堆区：用于存放new产生对象的实体，每一个对象实体均会有自己的内存地址，一旦这个内存地址不被任何栈区对象引用，就会成为垃圾，随时会被GC回收。</li>
</ul>
<a id="more"></a>

<h2 id="成员变量和局部变量"><a href="#成员变量和局部变量" class="headerlink" title="成员变量和局部变量"></a>成员变量和局部变量</h2><ul>
<li>成员变量：在类中方法外，存储在堆内存中，随着对象的存在而存在，随着对象的消失而消失。有默认的初始化值。</li>
<li>局部变量：在方法体中，存储在栈内存中，随着方法的调用而存在，随着方法的调用完毕而消失。没有默认的初始化值，所以必须先定义，赋值后才可以被使用。</li>
</ul>
<h2 id="对象创建过程"><a href="#对象创建过程" class="headerlink" title="对象创建过程"></a>对象创建过程</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> combendy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo_04</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Inner inner1 = <span class="keyword">new</span> Inner();</span><br><span class="line">        Inner inner2 = <span class="keyword">new</span> Inner(<span class="number">30</span>);</span><br><span class="line">        System.out.println((inner1.ii==inner2.ii)+<span class="string">&quot; &quot;</span>+Inner.ii);</span><br><span class="line">        System.out.println(inner1.str==inner2.str);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Inner</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String str=<span class="string">&quot;hello&quot;</span>;     <span class="comment">//成员变量 存储在堆内存中</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> ii=<span class="number">10</span>;    <span class="comment">//静态变量，存储在方法区中（这也是为什么静态变量能在多个对象共享的原因）</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> iii;</span><br><span class="line"><span class="comment">//        静态代码块</span></span><br><span class="line">        <span class="keyword">static</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ii=&quot;</span>+ii+<span class="string">&quot;,iii=&quot;</span>+iii);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;str=&quot;</span>+str+<span class="string">&quot;,i=&quot;</span>+i+<span class="string">&quot;,ii=&quot;</span>+ii+<span class="string">&quot;,iii=&quot;</span>+iii);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Inner</span><span class="params">()</span></span>&#123;</span><br><span class="line">            ii=<span class="number">20</span>;</span><br><span class="line">            System.out.println(<span class="string">&quot;non-arguments&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Inner</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.i=i;</span><br><span class="line">            System.out.println(<span class="string">&quot;one-arguments&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h3><blockquote>
<p>Hello<br>ii=10,iii=0<br>str=hello,i=0,ii=10,iii=0<br>non-arguments<br>str=hello,i=0,ii=20,iii=0<br>one-arguments<br>true 20<br>true</p>
</blockquote>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><ol>
<li>将JVM加载进内存中</li>
<li>JVM首先检查public类是否存在，存在就会将他加载进内存方法去中，否者抛出异常，结束进程</li>
<li>对类中静态字段进行初始化（若无显示初始化，就会被赋值为默认值），接着执行静态代码块</li>
<li>在栈中创建局部变量，堆中创建对象实体，为堆对象实体的成员变量（非静态）初始化，对于静态字段只需要从方法区的静态区中引用其值即可，执行构造代码块，接着执行构造函数（这里调用顺序会一直上溯到Object类，每一个构造方法的第一行为super()语句），最后将对象实体堆地址赋值给栈中引用变量。</li>
</ol>
<p><em>要注意的是，实例字段包括自身定义的和从父类继承下来的</em>（即使父类的实例字段被子类覆盖或者被private修饰，都照样为其分配内存）</p>
<p>C++中的引用和JAVA的引用作对比，其实他们两个只是“名称”一样，本质并没什么关系，C++中的引用只是给现存变量起了一个别名(引用变量只是一个符号引用而已，编译器并不会给引用分配新的内存)，而JAVA中的引用变量却是真真正正的变量，具有自己的内存空间，只是不同的引用变量可以“指向”同一个对象而已。因此，如果要拿C++和JAVA引用对象的方式相对比，C++中的指针倒和JAVA中的引用如出一辙，毕竟，JAVA中的引用其实就是对指针的封装</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Java基础/">Java基础</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Java/">Java</a>
    </span>
    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2021 XiaoBendy
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>